<!DOCTYPE html>
<html lang="en" ng-app="TrailApp">
  <head>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <meta name="viewport" content="initial-scale=1"/>
  </head>
  <body ng-controller="MainCtrl" ng-cloak class="ng-cloak">
    <md-toolbar layout="row" >
      <div class="md-toolbar-tools">
        <i ng-click="toggleLeft()" class="md-primary fa fa-bars fa-lg" id='side-nav-button'></i>
        <h1 class="trail-name">Welcome to Trail</h1>
      </div>
    </md-toolbar>
    <div class="contents">
      <div layout="row" flex>
        <div layout="column" flex id="content">
          <md-content layout="column" flex class="md-padding">
            <md-list>
              <md-subheader class="md-no-sticky">OKR RESULTS</md-subheader>
              <md-divider ></md-divider>
              <div layout="row" ng-show="isLoading" layout-sm="column" layout-align="space-around" style="position:fixed; top: 50%; left:50%;">
                <md-progress-circular md-mode="indeterminate"></md-progress-circular>
              </div>
              <div ng-hide="isLoading">
                <md-list-item class="md-2-line" ng-repeat="card in cards | cardFilter: filterArray" ng-click="showCardDetails($event,card)">
                  <img ng-if="avatarHash[card.membersid[0]]" ng-src="{{avatarHash[card.membersid[0]]}}" class="md-avatar" alt="" style="display:inline"/>
                  <span class="member-initials" ng-if="!avatarHash[card.membersid[0]]">{{initials[card.membersid[0]]}}</span>
                  <div class="md-list-item-text">
                    <div layout="row" layout-align="start center">
                      <h3 class="md-title" style="display:inline" flex>{{card.name}}</h3>
                      <span ng-repeat="key in card.keyResults">
                        <i class="fa fa-check" ng-if="key.status === 'complete'">
                          <md-tooltip>{{key.name}}</md-tooltip>
                        </i>
                        <i class="fa fa-question" ng-if="key.status === 'incomplete'">
                          <md-tooltip>{{key.name}}</md-tooltip>
                        </i>
                      </span>
                    </div>
                    <p ng-repeat="label in card.labels" class="label">{{label}}</p>
                    <md-divider ></md-divider>
                  </div>
                </md-list-item>
              </div>
          </md-content>
        </div>
      </div>
    </div>
    <md-sidenav class="md-sidenav-left md-whiteframe-z1" id='md-sidenav-style' md-component-id="left">
      <md-toolbar>
        <!-- TO-DO: add a close button -->
        <h1 class="md-toolbar-tools filters">
          Filters
        </h1>
      </md-toolbar>
      <md-content layout-padding>
        <p hide-md show-gt-md>
          <div>
            <h2 class="md-title filter-member">Filter by department</h2>

            <md-checkbox  ng-repeat="label in allCardLabels" ng-model='selected' ng-change="filterLabel(label, selected)" class="label-name">{{label}}</md-checkbox>
          </div>
        </p>
        <p hide-md show-gt-md>
          <div>
            <h2 class="md-title filter-member">Filter by member</h2>

            <md-checkbox  ng-repeat="member in allCardMembers" ng-model='selected' ng-change="filterMember(member.id, selected)" class="member-name">{{member.name}}</md-checkbox>
          </div>
        </p>
      </md-content>
    </md-sidenav>
    <!-- Angular Material Dependencies -->
    <!-- The client library requires jQuery  -->
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="https://api.trello.com/1/client.js?key=856a958ea5314dd93e14e7602783fc7c"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.9.3/lodash.min.js"></script>
    <script src="js/app.js"></script>
    <script src="js/trello.service.js"></script>
    <script src="js/card.filter.js"></script>
  </body>
</html>
